<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Automobilismo</title>
    <link rel="stylesheet" href="styles.css">

</head>

<body>



    <div class="logo">
        <h1><a href="../home.html" class="logoempresa"><img width="150px" height="130px"
                    src="assets/Captura_de_tela_2024-05-05_181840-removebg-preview.png" alt=""></a></h1>
    </div>

    <div class="quiz-container">
        <div class="question">
            <h2 id="texto-pergunta"></h2>
        </div>
        <div class="opcoes" id="container-opcoes"></div>
        <div class="feedback" id="texto-feedback"></div>
        <button id="btn-proxima" onclick="proximaPergunta()" disabled>Próxima Pergunta</button>

    </div>



    <script src="quiz.js"></script>
</body>

</html>
<script>
    var perguntasGlobal = []
    function proximaPergunta() {
        fetch("/usuarios/quiz", {
            method: 'GET',
            headers: {
                "Content-Type": "application/json"
            },
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO QUIZ()!")

            if (resposta.ok) {
                console.log(resposta);

                resposta.json().then(json => {

                    perguntasGlobal = json;
                    for (i = 1; i <= json.length; i++) {

                        console.log(json[i - 1])
    
                        var Pergunta = document.getElementById('texto-pergunta');
                        var opcoes = document.getElementById('container-opcoes');
                        var dadosPerguntaAtual = json[perguntaAtual];
    
                        Pergunta.innerHTML = dadosPerguntaAtual.pergunta;
                        opcoes.innerHTML = '';
    
    
                        dadosPerguntaAtual.opcoes.forEach(opcao => {
                            var botao = document.createElement('button');
                            botao.textContent = opcao;
                            botao.classList.add('opcao-btn');
                            botao.addEventListener('click', () => verificarResposta(opcao));
                            opcoes.appendChild(botao);
    
                            document.getElementById('btn-proxima').disabled = true;
                        });
    
    
    
                    }
                })
            } else {

                console.log('ERRO')

                resposta.text().then(texto => {
                    console.error(texto);

                });


            }
        })


    }

    function verificarResposta(respostaUsuario) {
        var dadosPerguntaAtual = perguntasGlobal[perguntaAtual];
        var elementoTextoFeedback = document.getElementById('texto-feedback');
         
        if (respostaUsuario === dadosPerguntaAtual.resposta) {
            pontuacao++;
            elementoTextoFeedback.innerHTML = "Resposta correta!";
            elementoTextoFeedback.style.color = "green";
        } else {
            elementoTextoFeedback.innerHTML = "Resposta incorreta.";
            elementoTextoFeedback.style.color = "red";
        }

        document.getElementById('btn-proxima').disabled = false;

        var botoesOpcao = document.querySelectorAll('.opcao-btn');
        botoesOpcao.forEach(botao => {
            botao.disabled = true;
        });

        elementoTextoFeedback.innerHTML= "";            
    }

    function proximaPergunta() {
        perguntaAtual++;
        
        if (perguntaAtual < perguntasGlobal.length) {
            carregarPergunta(); 
        } else {
            
            var Pergunta = document.getElementById('texto-pergunta');
            Pergunta.innerHTML = `Você acertou ${pontuacao} de ${perguntasGlobal.length} perguntas.`;

            
            document.getElementById('container-opcoes').innerHTML = '';
            document.getElementById('texto-feedback').innerHTML = '';

            
            document.getElementById('btn-proxima').style.display = 'none';
        }
    }

    

</script>